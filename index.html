<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Neon Bastion - Tower Defense</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;500;700&family=Syne:wght@600;700&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="styles.css?v=20260220g" />
  </head>
  <body>
    <section class="menu-screen" id="menuScreen" aria-label="Main menu">
      <div class="menu-card" id="menuCard" data-view="home">
        <div id="menuHomeView">
          <p class="menu-kicker">Neon Bastion</p>
          <p id="buildStamp" class="build-stamp">Build: loading...</p>
          <h1>Command Uplink</h1>
          <p class="menu-copy">Build your first defense line, then launch waves when you are ready.</p>
          <div class="menu-action-row">
            <button id="openAccountBtn" type="button">Account Setup</button>
            <button id="openUnlockShopBtn" type="button">Open Tower Unlock Shop</button>
            <button id="openLoadoutBtn" type="button">Change Loadout</button>
            <button id="openMultiplayerBtn" type="button">Multiplayer</button>
            <div class="menu-map-select" aria-label="Map selector">
              <button id="mapPrevBtn" type="button" aria-label="Previous map">&lt;</button>
              <div id="mapPreview" class="menu-map-preview" data-map-theme="neon">
                <p id="mapPreviewIndex">Map 1 / 3</p>
                <h3 id="mapPreviewName">Level 1 - Neon Bastion</h3>
                <p id="mapPreviewDesc">Classic defense route with balanced pressure.</p>
                <span id="mapPreviewLock" class="menu-map-lock unlocked">Unlocked</span>
              </div>
              <button id="mapNextBtn" type="button" aria-label="Next map">&gt;</button>
            </div>
            <button id="playBtn" class="menu-play-btn" type="button">Start Playing</button>
          </div>
        </div>

        <section id="menuAccountPanel" class="menu-shop-panel" aria-label="Account setup">
          <div class="menu-shop-head">
            <h2>Account Setup</h2>
            <span id="menuAccountCurrent">Account: -</span>
          </div>
          <div class="menu-account-auth">
            <section class="menu-account-form" aria-label="Create account">
              <h3>Create Account</h3>
              <input
                id="accountCreateUsernameInput"
                type="text"
                autocomplete="off"
                spellcheck="false"
                maxlength="24"
                placeholder="Username"
              />
              <input
                id="accountCreatePasswordInput"
                type="password"
                autocomplete="new-password"
                spellcheck="false"
                maxlength="48"
                placeholder="Password"
              />
              <input
                id="accountCreatePasswordConfirmInput"
                type="password"
                autocomplete="new-password"
                spellcheck="false"
                maxlength="48"
                placeholder="Confirm password"
              />
              <button id="createAccountBtn" type="button">Create</button>
            </section>
            <section class="menu-account-form" aria-label="Login">
              <h3>Login</h3>
              <input
                id="accountLoginUsernameInput"
                type="text"
                autocomplete="off"
                spellcheck="false"
                maxlength="24"
                placeholder="Username"
              />
              <input
                id="accountLoginPasswordInput"
                type="password"
                autocomplete="current-password"
                spellcheck="false"
                maxlength="48"
                placeholder="Password"
              />
              <button id="loginAccountBtn" type="button">Login</button>
            </section>
          </div>
          <div id="menuAccountList" class="menu-shop-list"></div>
          <p class="menu-shop-note">Progress is saved per account. Create with username + password, then login with the same credentials.</p>
          <div class="menu-shop-actions">
            <button id="closeAccountBtn" class="menu-play-btn" type="button">Menu Page</button>
          </div>
        </section>

        <section id="menuShopPanel" class="menu-shop-panel" aria-label="Tower unlock shop">
          <div class="menu-shop-head">
            <h2>Tower Unlock Shop</h2>
            <span id="menuShards"><span class="shard-word-inline">Shards</span>: 0</span>
          </div>
          <div id="menuShop" class="menu-shop-list"></div>
          <p class="menu-shop-note">
            Earn <span class="shard-word-inline">shards</span> from cleared waves: 1% of wave credits, rounded up. Spend
            <span class="shard-word-inline">shards</span> on tower unlocks.
          </p>
          <div class="menu-shop-actions">
            <button id="openCreatureFromUnlockBtn" type="button">Creature Spawner Shop</button>
            <button id="openTrapFromUnlockBtn" type="button">Trap Shop</button>
            <button id="closeUnlockShopBtn" class="menu-play-btn" type="button">Menu Page</button>
          </div>
        </section>

        <section id="menuCreaturePanel" class="menu-shop-panel" aria-label="Creature spawner shop">
          <div class="menu-shop-head">
            <h2>Creature Spawner Shop</h2>
            <span id="menuCreatureSummary">Unlocked: 0</span>
          </div>
          <div id="menuCreatureShop" class="menu-shop-list"></div>
          <p class="menu-shop-note">
            Kill enemies to unlock their spawner tower. Spawned allies are green and march from core to entry.
          </p>
          <div class="menu-shop-actions">
            <button id="closeCreatureShopBtn" class="menu-play-btn" type="button">Menu Page</button>
          </div>
        </section>

        <section id="menuTrapPanel" class="menu-shop-panel" aria-label="Trap shop">
          <div class="menu-shop-head">
            <h2>Trap Shop</h2>
            <span id="menuTrapSummary">Unlocked: 0/0</span>
          </div>
          <div id="menuTrapShop" class="menu-shop-list"></div>
          <p class="menu-shop-note">
            Trap unlocks are purchased with <span class="shard-word-inline">shards</span>. Traps place on lane tiles and only hit enemies.
          </p>
          <div class="menu-shop-actions">
            <button id="closeTrapShopBtn" class="menu-play-btn" type="button">Menu Page</button>
          </div>
        </section>

        <section id="menuLoadoutPanel" class="menu-shop-panel" aria-label="Tower loadout">
          <div class="menu-shop-head">
            <h2>Tower Loadout</h2>
            <span id="menuLoadoutCount">0/0 Equipped</span>
          </div>
          <input
            id="menuLoadoutSearch"
            type="text"
            autocomplete="off"
            spellcheck="false"
            maxlength="24"
            placeholder="Search unlocked towers"
          />
          <div id="menuLoadout" class="menu-shop-list"></div>
          <p class="menu-shop-note">Only unlocked towers, traps, and spawners can be equipped. Use Upgrade next to Equip to open all upgrades.</p>
          <div class="menu-shop-actions">
            <button id="closeLoadoutBtn" class="menu-play-btn" type="button">Menu Page</button>
          </div>
        </section>

        <section id="menuMultiplayerPanel" class="menu-shop-panel" aria-label="Multiplayer">
          <div class="menu-shop-head">
            <h2>Multiplayer</h2>
            <span id="menuMultiplayerState">Solo</span>
          </div>
          <div class="menu-multiplayer-config">
            <div class="menu-multiplayer-server-row">
              <label for="multiplayerServerInput">Server URL</label>
              <input
                id="multiplayerServerInput"
                type="url"
                autocomplete="off"
                spellcheck="false"
                maxlength="180"
                placeholder="Server URL (wss://your-server.example)"
              />
            </div>
            <div class="menu-multiplayer-room-row">
              <label for="multiplayerRoomInput">Room Code</label>
              <input
                id="multiplayerRoomInput"
                type="text"
                autocomplete="off"
                spellcheck="false"
                maxlength="16"
                placeholder="Room code"
              />
              <div class="menu-multiplayer-room-actions">
                <button id="hostMultiplayerBtn" type="button">Create Room</button>
                <button id="joinMultiplayerBtn" type="button">Join Room</button>
                <button id="leaveMultiplayerBtn" type="button">Leave Room</button>
              </div>
            </div>
          </div>
          <p id="menuMultiplayerHint" class="menu-shop-note menu-multiplayer-hint">Enter a room code, then Create or Join.</p>
          <div class="menu-multiplayer-panels">
            <section class="menu-multiplayer-pane menu-multiplayer-pane-players">
              <div class="menu-shop-head menu-multiplayer-players-head">
                <h3>Players In Room</h3>
                <span id="menuMultiplayerPlayerCount">0</span>
              </div>
              <div id="menuMultiplayerPlayers" class="menu-shop-list menu-multiplayer-players"></div>
            </section>
            <section class="menu-multiplayer-pane menu-multiplayer-pane-log">
              <div class="menu-shop-head menu-multiplayer-log-head">
                <h3>Room Log</h3>
              </div>
              <div id="menuMultiplayerLog" class="menu-shop-list menu-multiplayer-log"></div>
            </section>
          </div>
          <p class="menu-shop-note menu-multiplayer-note">
            Use the same server URL and room code on every device. Host is authoritative and shares the game state.
          </p>
          <div class="menu-shop-actions menu-multiplayer-footer">
            <button id="closeMultiplayerBtn" class="menu-play-btn" type="button">Menu Page</button>
          </div>
        </section>
      </div>
    </section>

    <section class="confirm-screen" id="exitConfirm" aria-label="Exit map confirmation" hidden>
      <div class="confirm-card">
        <h2>Exit Map?</h2>
        <p>Are you sure you want to exit the map?</p>
        <div class="confirm-actions">
          <button id="cancelExitBtn" type="button">No, Stay</button>
          <button id="confirmExitBtn" type="button">Yes, Exit</button>
        </div>
      </div>
    </section>

    <section class="confirm-screen" id="levelClearPanel" aria-label="Level clear" hidden>
      <div class="confirm-card">
        <h2 id="levelClearTitle">Level Cleared</h2>
        <p id="levelClearText">Victory confirmed. New map access awarded.</p>
        <div class="confirm-actions">
          <button id="levelClearMenuBtn" type="button">Menu</button>
        </div>
      </div>
    </section>

    <section class="confirm-screen" id="defeatPanel" aria-label="Defeat" hidden>
      <div class="confirm-card">
        <h2>Defeat!</h2>
        <p>Your core was destroyed.</p>
        <div class="confirm-actions">
          <button id="defeatMenuBtn" type="button">Menu</button>
        </div>
      </div>
    </section>

    <main class="shell">
      <header class="hud">
        <div class="hud-top">
          <div class="brand-block">
            <h1>Neon Bastion</h1>
            <div class="stats">
              <span id="money">Credits: 0</span>
              <span id="shards"><span class="shard-word-inline">Shards</span>: 0</span>
              <span id="lives">Core HP: 0</span>
              <span id="wave">Wave: 0</span>
              <span id="multiplayerPlayersHud">Players: Solo</span>
            </div>
          </div>

          <div class="controls">
            <div class="controls-group">
              <button id="buildBtn" type="button">Build Tower</button>
              <button id="sellBtn" type="button">Sell Tower</button>
              <button id="laneBtn" type="button">Edit Lanes</button>
              <button id="startWaveBtn" type="button">Start Wave</button>
              <button id="pauseBtn" type="button">Pause</button>
              <button id="menuBtn" type="button">Menu Shop</button>
            </div>
          </div>
        </div>

        <div class="shop-panel">
          <h2>Tower Shop</h2>
          <div id="shop" class="shop" aria-label="Tower shop"></div>
        </div>
        <section id="bossBarWrap" class="boss-bar-wrap" aria-label="Boss health" hidden>
          <div class="boss-bar-head">
            <strong id="bossName">Boss</strong>
            <span id="bossHp">0 / 0</span>
          </div>
          <div class="boss-bar-track">
            <div id="bossBarFill" class="boss-bar-fill"></div>
            <div id="bossBarSplit" class="boss-bar-split" hidden>
              <div class="boss-bar-half boss-bar-half-left">
                <div id="bossBarFillLeft" class="boss-bar-half-fill"></div>
              </div>
              <div class="boss-bar-half boss-bar-half-right">
                <div id="bossBarFillRight" class="boss-bar-half-fill"></div>
              </div>
              <div class="boss-bar-center-cut"></div>
            </div>
          </div>
        </section>
        <p id="status" class="status"></p>
      </header>

      <section class="arena-wrap">
        <canvas id="game" width="1280" height="720" aria-label="Tower defense battlefield"></canvas>
      </section>
    </main>

    <div id="speedControl" class="speed-control" aria-label="Game speed controls">
      <button id="speedDownBtn" type="button" aria-label="Decrease speed">&lt;</button>
      <span id="speedValue">1.0x</span>
      <button id="speedUpBtn" type="button" aria-label="Increase speed">&gt;</button>
    </div>
    <button id="settingsToggleBtn" class="settings-toggle-btn" type="button" aria-label="Open settings">
      &#9881;
    </button>
    <section id="settingsPanel" class="settings-panel" aria-label="Game settings" hidden>
      <div class="settings-panel-head">
        <div class="settings-panel-title">
          <strong id="settingsPanelTitle">Audio & Visual Settings</strong>
          <span id="settingsPageHint">Page 1 / 2</span>
        </div>
        <div class="settings-panel-controls">
          <button id="settingsPrevPageBtn" type="button" aria-label="Previous settings page">&lt;</button>
          <button id="settingsNextPageBtn" type="button" aria-label="Next settings page">&gt;</button>
          <button id="settingsCloseBtn" type="button" aria-label="Close settings">X</button>
        </div>
      </div>
      <div id="settingsPageToggles" class="settings-grid">
        <div class="settings-row">
          <span>Music</span>
          <button id="settingMusicBtn" type="button">On</button>
        </div>
        <div class="settings-row">
          <span>All SFX</span>
          <button id="settingSfxBtn" type="button">On</button>
        </div>
        <div class="settings-row">
          <span>Tower Shots</span>
          <button id="settingShotBtn" type="button">On</button>
        </div>
        <div class="settings-row">
          <span>Glass Shatter</span>
          <button id="settingShatterBtn" type="button">On</button>
        </div>
        <div class="settings-row">
          <span>Explosion Particles</span>
          <button id="settingExplosionBtn" type="button">On</button>
        </div>
        <div class="settings-row">
          <span>Enemy Rings</span>
          <button id="settingEnemyRingsBtn" type="button">On</button>
        </div>
      </div>
      <div id="settingsPageHotkeys" class="settings-hotkeys" hidden>
        <div class="settings-hotkey-row"><span>Pause / Resume</span><strong>P</strong></div>
        <div class="settings-hotkey-row"><span>Open Menu</span><strong>M</strong></div>
        <div class="settings-hotkey-row"><span>Build Mode</span><strong>B</strong></div>
        <div class="settings-hotkey-row"><span>Sell Mode</span><strong>X</strong></div>
        <div class="settings-hotkey-row"><span>Edit Lanes</span><strong>L</strong></div>
        <div class="settings-hotkey-row"><span>Start Wave</span><strong>Space</strong></div>
        <div class="settings-hotkey-row"><span>Multiplayer Panel</span><strong>G</strong></div>
        <div class="settings-hotkey-row"><span>Open Chat (Multiplayer)</span><strong>T / /</strong></div>
      </div>
    </section>
    <button id="commandToggleBtn" class="command-toggle-btn" type="button" aria-label="Open command console">
      CMD
    </button>
    <button id="chatToggleBtn" class="chat-toggle-btn" type="button" aria-label="Open multiplayer chat" hidden>
      CHAT
    </button>
    <button id="autoWaveBtn" class="auto-wave-toggle-btn" type="button" aria-label="Toggle auto waves">
      Auto: Off
    </button>
    <section id="commandConsole" class="command-console" aria-label="Command console" hidden>
      <div class="command-console-head">
        <strong>Command Console</strong>
        <button id="commandCloseBtn" type="button" aria-label="Close command console">X</button>
      </div>
      <div class="command-console-row">
        <input id="commandInput" type="text" autocomplete="off" spellcheck="false" placeholder="Enter command" />
        <button id="commandRunBtn" type="button">Run</button>
      </div>
    </section>
    <section id="chatPanel" class="chat-panel" aria-label="Multiplayer chat" hidden>
      <div class="chat-panel-head">
        <strong>Team Chat</strong>
        <button id="chatCloseBtn" type="button" aria-label="Close multiplayer chat">X</button>
      </div>
      <div id="chatMessages" class="chat-messages"></div>
      <div class="chat-row">
        <input id="chatInput" type="text" autocomplete="off" spellcheck="false" maxlength="140" placeholder="Type message..." />
        <button id="chatSendBtn" type="button">Send</button>
      </div>
    </section>

    <script src="vendor/three.min.js"></script>
    <script src="game.js?v=20260220k"></script>
  </body>
</html>
